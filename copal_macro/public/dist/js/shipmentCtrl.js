"use strict";function preview_image(){for(var e=countimg+1,t=document.getElementById("upload_file").files.length,a=0;a<t;a++)$("#image_preview").append("<div class='preview' id='prev"+e+"'><div class='divimg'><img class='thumbnailp' src='"+URL.createObjectURL(event.target.files[a])+"'></div><a class='removeimg' onclick=remove_preview('prev"+e+"')>Eliminar</a>")}function remove_preview(e){console.log,$("#"+e).remove()}var aux;$(document).ready(function(){$("select").select2().on("select2:select",function(e){"ics_shipper_select"==$(e.currentTarget).attr("id")&&setShipperData(eval("("+$(e.currentTarget).find("option:selected").attr("item")+")"))}),$("select").select2().on("select2:select",function(e){"ics_entityToNotify_select"==$(e.currentTarget).attr("id")&&setentityToNotifyData(eval("("+$(e.currentTarget).find("option:selected").attr("item")+")"))}),$("select").select2().on("select2:select",function(e){"ics_cargoAgent_select"==$(e.currentTarget).attr("id")&&setcargoAgentData(eval("("+$(e.currentTarget).find("option:selected").attr("item")+")"))}),$("select").select2().on("select2:select",function(e){"ics_consigneer_select"==$(e.currentTarget).attr("id")&&setconsigneerData(eval("("+$(e.currentTarget).find("option:selected").attr("item")+")"))}),$("select").select2().on("select2:select",function(e){"ics_intermediate_select"==$(e.currentTarget).attr("id")&&setintermediateData(eval("("+$(e.currentTarget).find("option:selected").attr("item")+")"))}),$("select").select2().on("select2:select",function(e){"ics_destinyAgent_select"==$(e.currentTarget).attr("id")&&setdestinyAgentData(eval("("+$(e.currentTarget).find("option:selected").attr("item")+")"))}),$("#realizationDate_shipment").datepicker({dateFormat:"yy-mm-dd"}),$("#realizationHour_shipment").datetimepicker({format:"HH:mm:ss"}),$("#dtble").DataTable({order:[[0,"desc"]]}),$("#dtble2").DataTable({order:[[0,"desc"]]}),$("#dtble3").DataTable({order:[[0,"desc"]]}),aux=""==$("#ics_Hd_Count_Cargo").val()?0:$("#ics_Hd_Count_Cargo").val(),aux=parseInt(aux),initDropzone()});var initDropzone=function(){Dropzone.options.myDropzone={autoProcessQueue:!1,uploadMultiple:!1,parallelUploads:100,maxFilesize:8,addRemoveLinks:!0,dictRemoveFile:"eliminar",dictFileTooBig:"Image is bigger than 8MB",init:function(){var e=document.querySelector("#submit-all"),t=this;e.addEventListener("click",function(e){e.preventDefault(),t.processQueue(),$("#ics_shipmen_form").submit()}),this.on("addedfile",function(){}),this.on("complete",function(e){t.removeFile(e)}),this.on("success",t.processQueue.bind(t)),t.on("sending",function(e,t,a){a.append("filesize",e.size)})}}},icsChangeStatusShipment=function(e){var t=$("#ics_shipment_status").val(),a=$("#observation").val(),i=window.location.origin+window.location.pathname+"/"+e+"/read";$.ajax({url:i,method:"POST",dataType:"json",data:{status:t,observation:a},beforeSend:function(){},success:function(e){1==e.message&&$("#load").load(i,function(){$("select").select2()})},error:function(e){bootbox.alert("Error: "+e.message)}})},icsSetTypeShipment=function(id,edit,shipment){var url=0==edit?window.location.origin+window.location.pathname+"/"+id+"/type/shipment/"+shipment:window.location.origin+AUX_PATH+"/admin/shipments/new/"+id+"/type/shipment/"+shipment;$.ajax({url:url,type:"GET",dataType:"json",data:id,beforeSend:function(){$("#ics_load").html("<i class='fa fa-spin fa-spinner'></i> Cargando...")},success:function(json){$("#ics_complentary_info").load(json.generalInfo,function(){1==id&&($("#since_departure_maritime").datepicker({dateFormat:"yy-mm-dd"}),$("#since_arrived_maritime").datepicker({dateFormat:"yy-mm-dd"}),$("#hour_arrived_maritime").datetimepicker({format:"HH:mm:ss"}),$("#hour_departure_maritime").datetimepicker({format:"HH:mm:ss"}),$("#ics_selected_item").html("(Maritimo Seleccionado)")),2==id&&($("#carrier_aerial").select2(),$("#ics_selected_item").html("(Aereo Seleccionado)")),3==id&&$("#ics_selected_item").html("(Terrestre Seleccionado)")}),$("#ics_fielset_load_routes_info").load(json.routesInfo,function(){1==id&&$("select").select2().on("select2:select",function(e){"vesselMaritime_shipment"==$(e.currentTarget).attr("id")&&setVesselData(eval("("+$(e.currentTarget).find("option:selected").attr("item")+")"))}),2==id&&($("#departureDateAerial_shipment").datepicker({dateFormat:"yy-mm-dd"}),$("#arrivedDateAerial_shipment").datepicker({dateFormat:"yy-mm-dd"}),$("#hourDepeartureAerial_shipment").datetimepicker({format:"HH:mm:ss"}),$("#hourArrivedAerial_shipment").datetimepicker({format:"HH:mm:ss"}),$("select").select2()),3==id&&($("#fromDateGround_shipment").datepicker({dateFormat:"yy-mm-dd"}),$("#toDateGround_shipment").datepicker({dateFormat:"yy-mm-dd"}),$("#fromHourGround_shipment").datetimepicker({format:"HH:mm:ss"}),$("#toHourGround_shipment").datetimepicker({format:"HH:mm:ss"}),$("select").select2())})},error:function(){log("no se ha cargado"+url)},complete:function(){$("#ics_load").html("")}}),$("#ics_Hd_Type_Shipment").val(id)},icsShipmentDelete=function(element,from){try{var shipment=getItem(element)||getItemFromParent(element),url=window.location.origin+window.location.pathname+"/"+shipment.id;void 0!=shipment&&bootbox.confirm(eval(msg(messages.delete)),function(e){e&&doForm(url,"delete",void 0,void 0===from||from)})}catch(e){log(e)}},setVesselData=function(e){e?($("#vesselFlagMaritime_shipment").val(e.flag),$("#vesselFlagMaritime_shipment").attr("readonly",!0)):($("#vesselFlagMaritime_shipment").val(""),$("#vesselFlagMaritime_shipment").attr("readonly",!1))},setShipperData=function(e){e?($("#ics_shipper_name").val(e.name),$("#ics_shipper_address").val(e.address),$("#ics_shipper_name").attr("readonly",!0),$("#ics_shipper_address").attr("readonly",!0)):($("#ics_shipper_name").val(""),$("#ics_shipper_address").val(""),$("#ics_shipper_name").attr("readonly",!1),$("#ics_shipper_address").attr("readonly",!1))},setentityToNotifyData=function(e){e?($("#ics_entityToNotify_name").val(e.name),$("#ics_entityToNotify_address").val(e.address),$("#ics_entityToNotify_name").attr("readonly",!0),$("#ics_entityToNotify_address").attr("readonly",!0)):($("#ics_entityToNotify_name").val(""),$("#ics_entityToNotify_address").val(""),$("#ics_entityToNotify_name").attr("readonly",!1),$("#ics_entityToNotify_address").attr("readonly",!1))},setcargoAgentData=function(e){e?($("#ics_cargoAgent_name").val(e.name),$("#ics_cargoAgent_address").val(e.address),$("#ics_cargoAgent_name").attr("readonly",!0),$("#ics_cargoAgent_address").attr("readonly",!0)):($("#ics_cargoAgent_name").val(""),$("#ics_cargoAgent_address").val(""),$("#ics_cargoAgent_name").attr("readonly",!1),$("#ics_cargoAgent_address").attr("readonly",!1))},setconsigneerData=function(e){e?($("#ics_consigneer_name").val(e.name),$("#ics_consigneer_address").val(e.address),$("#ics_consigneer_name").attr("readonly",!0),$("#ics_consigneer_address").attr("readonly",!0)):($("#ics_consigneer_name").val(""),$("#ics_consigneer_address").val(""),$("#ics_consigneer_name").attr("readonly",!1),$("#ics_consigneer_address").attr("readonly",!1))},setintermediateData=function(e){e?($("#ics_intermediate_name").val(e.name),$("#ics_intermediate_address").val(e.address),$("#ics_intermediate_name").attr("readonly",!0),$("#ics_intermediate_address").attr("readonly",!0)):($("#ics_intermediate_name").val(""),$("#ics_intermediate_address").val(""),$("#ics_intermediate_name").attr("readonly",!1),$("#ics_intermediate_address").attr("readonly",!1))},setdestinyAgentData=function(e){e?($("#ics_destinyAgent_name").val(e.name),$("#ics_destinyAgent_address").val(e.address),$("#ics_destinyAgent_name").attr("readonly",!0),$("#ics_destinyAgent_address").attr("readonly",!0)):($("#ics_destinyAgent_name").val(""),$("#ics_destinyAgent_address").val(""),$("#ics_destinyAgent_name").attr("readonly",!1),$("#ics_destinyAgent_address").attr("readonly",!1))},countimg=0;